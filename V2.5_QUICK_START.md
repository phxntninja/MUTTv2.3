# MUTT v2.5 Quick Start Guide

**Goal:** Transform MUTT v2.3 â†’ v2.5 (Enterprise-Ready)
**Time:** 25-35 hours over 2-3 weeks
**Tasks:** 60+ atomic tasks

---

## What You'll Build

### v2.5 Key Features

1. **Configuration Hot-Reloading** - Change settings without restart
2. **Zero-Downtime Secret Rotation** - Rotate passwords while running
3. **Advanced Backpressure** - Automatic load shedding at 100k+ events/sec
4. **Config Audit Trail** - Track who changed what, when, and why
5. **Auto-Remediation** - Self-healing DLQ replay
6. **SLO Tracking** - Monitor and enforce service level objectives
7. **API Versioning** - v1/v2 compatibility with deprecation strategy
8. **Data Retention** - Automated archival and compliance
9. **Developer CLI** - One-command setup with `muttdev`
10. **Architecture Decision Records** - Document key technical decisions

---

## Getting Started

### Prerequisites
- MUTT v2.3 working in Kimi workspace âœ… (completed)
- Docker and Docker Compose installed
- PostgreSQL 13+ and Redis 7+
- Python 3.9+
- Git

### Step 1: Review the Plan (5 minutes)

```bash
cd "C:\Users\ronhi\OneDrive\Documents\AI Work\MUTT-rewrites\Kimi re-write"

# Read the implementation plan
cat V2.5_IMPLEMENTATION_PLAN.md

# Open the task tracker
cat V2.5_TASK_TRACKER.md
```

### Step 2: Create Feature Branch (2 minutes)

```bash
# Initialize git if not already done
git init
git add .
git commit -m "feat: MUTT v2.3 baseline for v2.5 development"

# Create feature branch for Phase 1
git checkout -b feature/v2.5-phase1
```

### Step 3: Start with Phase 1 (4-6 hours)

**Phase 1 builds the infrastructure** needed by all other features.

```bash
# Task 1.1.1: Create Config Audit Schema (20 min)
# Creates: database/config_audit_schema.sql

# Task 1.1.2: Update postgres-init.sql (10 min)
# Updates: database/postgres-init.sql

# Task 1.1.3: Create Audit Helper Library (30 min)
# Creates: services/audit_logger.py
# Creates: tests/test_audit_logger.py

# ... continue through all Phase 1 tasks
```

**When Phase 1 is complete:**
```bash
# Run all tests
pytest tests/ -v

# Commit and tag
git add .
git commit -m "feat: complete Phase 1 - Infrastructure & Database"
git tag v2.5-phase1-complete

# Update task tracker
# Mark all Phase 1 tasks as [x] complete
```

---

## Workflow for Each Task

### 1. Before Starting a Task

```markdown
- [ ] Read task description in V2.5_IMPLEMENTATION_PLAN.md
- [ ] Check dependencies (all [Depends: X.Y] tasks done?)
- [ ] Mark task as [IN PROGRESS] in V2.5_TASK_TRACKER.md
- [ ] Create file or open existing file
```

### 2. During Task Implementation

```python
# Follow the implementation sketch in the plan
# Write code
# Write tests (if applicable)
# Run tests locally
```

### 3. After Completing a Task

```bash
# Run tests
pytest tests/ -v

# Lint code
flake8 services/ tests/

# Format code
black services/ tests/

# Commit
git add .
git commit -m "feat(config): implement dynamic config class [Task 1.3.1]"

# Update tracker
# Change [ ] to [x] in V2.5_TASK_TRACKER.md
```

---

## Phase Completion Checklist

### After Each Phase

```bash
# 1. Run all existing tests
pytest tests/ -v --cov=services --cov-report=term-missing

# 2. Run new tests for this phase
pytest tests/test_<phase_name>*.py -v

# 3. Test in Docker Compose
docker-compose up -d
docker-compose ps  # All services healthy?
curl http://localhost:8080/health

# 4. Commit and tag
git add .
git commit -m "feat: complete Phase X - <phase name>"
git tag v2.5-phaseX-complete

# 5. Merge to develop branch (optional)
git checkout develop
git merge feature/v2.5-phaseX

# 6. Create next phase branch
git checkout -b feature/v2.5-phaseY
```

---

## Recommended Schedule

### Week 1: Foundation
- **Mon-Tue:** Phase 1 - Infrastructure & Database (4-6h)
- **Wed-Fri:** Phase 2 - Hot Reload & Secrets (6-8h)
- **End of Week Test:** Config hot-reload and secret rotation working

### Week 2: Reliability
- **Mon-Wed:** Phase 3 - Reliability & Observability (7-9h)
- **Thu-Fri:** Phase 4 - API & Compliance (5-7h)
- **End of Week Test:** Auto-remediation, SLO tracking, API versioning working

### Week 3: Polish & Ship
- **Mon-Tue:** Phase 5 - Developer Experience & Docs (4-6h)
- **Wed:** Phase 6 - Final Testing & Validation (3-4h)
- **Thu-Fri:** Load testing, security scanning, production deployment prep

---

## Task Sizing Reference

### ðŸŸ¢ Small Tasks (15-20 min)
- Creating schemas
- Adding env vars
- Writing single functions
- Simple documentation updates

### ðŸŸ¡ Medium Tasks (25-35 min)
- Creating helper libraries
- Adding API endpoints
- Writing unit tests
- Integration work

### ðŸ”´ Large Tasks (40-45 min)
- Creating new services
- Complex integration
- End-to-end testing
- Comprehensive documentation

**Note:** No task exceeds 45 minutes. If stuck, pause and ask for help!

---

## Testing Strategy

### Unit Tests (During Task)
```bash
# Test single file
pytest tests/test_audit_logger.py -v

# Test with coverage
pytest tests/test_audit_logger.py -v --cov=services.audit_logger
```

### Integration Tests (After Phase)
```bash
# Test all services together
docker-compose up -d
pytest tests/test_integration_v25.py -v
docker-compose down
```

### Load Tests (After Phase 3)
```bash
# Simulate 10k events/sec
python tests/load_test.py --rate=10000 --duration=60
```

---

## Common Issues & Solutions

### Issue: Database migration fails
**Solution:** Check existing data, run migration on backup first

### Issue: Service won't start after config change
**Solution:** Check logs with `docker-compose logs <service>`

### Issue: Tests failing after integration
**Solution:** Run `pytest --lf` to re-run last failures, check mocks

### Issue: Stuck on a task for >45 minutes
**Solution:** Mark as blocked in tracker, move to next independent task

---

## Progress Tracking

### Daily Standup Questions
1. **Yesterday:** Which tasks did I complete?
2. **Today:** Which tasks am I working on?
3. **Blockers:** Any tasks blocked or taking longer than expected?

### Weekly Review
1. **Completed:** Which phases are done?
2. **Testing:** Are all tests passing?
3. **Documentation:** Is documentation up to date?
4. **Next Week:** What's the plan?

---

## Files You'll Create/Modify

### New Files (30+)
```
database/config_audit_schema.sql
database/partitioned_event_audit_log.sql
services/audit_logger.py
services/dynamic_config.py
services/redis_connector.py
services/postgres_connector.py
services/remediation_service.py
services/slo_definitions.py
services/slo_checker.py
services/api_versioning.py
scripts/init_dynamic_config.py
scripts/create_monthly_partitions.py
scripts/archive_old_events.py
scripts/enforce_retention.py
configs/prometheus/slo_rules.yml
tools/muttdev/cli.py
tools/muttdev/commands/setup.py
tools/muttdev/commands/config.py
tools/muttdev/commands/logs.py
tools/install.sh
docs/adrs/template.md
docs/adrs/ADR-001-redis-over-kafka.md
docs/adrs/ADR-002-vault-over-k8s-secrets.md
docs/adrs/ADR-003-single-threaded-workers.md
docs/adrs/ADR-004-postgresql-audit-logs.md
docs/MIGRATION_v2.3_to_v2.5.md
docs/FEATURE_MATRIX.md
docs/SECRET_ROTATION_PROCEDURE.md
docs/API_REFERENCE.md
tests/test_audit_logger.py
tests/test_dynamic_config.py
tests/test_remediation.py
tests/test_integration_v25.py
... and more
```

### Modified Files (10+)
```
database/postgres-init.sql
services/ingestor_service.py
services/alerter_service.py
services/moog_forwarder_service.py
services/web_ui_service.py
docker-compose.yml
.env.template
README.md
... and more
```

---

## Success Criteria

### Technical
- âœ… All 135+ existing v2.3 tests pass
- âœ… 40+ new v2.5 tests added
- âœ… Code coverage >80%
- âœ… Zero-downtime config changes work
- âœ… Secret rotation tested successfully
- âœ… Auto-remediation functional
- âœ… SLO dashboard operational
- âœ… API versioning implemented
- âœ… Data retention automated

### Business
- âœ… Config audit trail 100% coverage
- âœ… SOX/GDPR compliance via audit logs
- âœ… Developer onboarding <30 min (muttdev)
- âœ… Zero-downtime operations enabled
- âœ… Self-healing reduces manual ops work

---

## Ready to Start?

### First Task: Task 1.1.1 (20 minutes)

**Goal:** Create the config audit schema

```bash
# Create the file
touch database/config_audit_schema.sql

# Refer to V2.5_IMPLEMENTATION_PLAN.md for the SQL

# When done:
git add database/config_audit_schema.sql
git commit -m "feat(database): add config audit schema [Task 1.1.1]"

# Update tracker
# Mark Task 1.1.1 as [x] complete in V2.5_TASK_TRACKER.md
```

---

## Questions?

- **For task details:** See `V2.5_IMPLEMENTATION_PLAN.md`
- **For progress tracking:** See `V2.5_TASK_TRACKER.md`
- **For v2.3 baseline:** See existing documentation
- **For architecture decisions:** See `docs/adrs/`

**Let's build v2.5! ðŸš€**
