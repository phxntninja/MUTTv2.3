# =====================================================================
# MUTT v2.3 - snmptrapd Configuration
# =====================================================================
# This file configures snmptrapd to receive SNMP traps and forward them
# to syslog (facility local5), which then forwards to MUTT Ingestor.
#
# Installation:
#   1. Copy to /etc/snmp/snmptrapd.conf
#   2. Restart snmptrapd: systemctl restart snmptrapd
#
# Flow:
#   SNMP Trap → snmptrapd → syslog (local5) → rsyslog → MUTT Ingestor
# =====================================================================

# Do not fork into background (systemd handles daemonization)
doNotFork yes

# Authentication - Accept all SNMP versions
# SNMPv1/v2c
authCommunity log,execute,net public

# SNMPv3 (if needed)
# createUser -e 0x8000000001020304 trapuser MD5 "authpassword" DES "privpassword"
# authUser log,execute trapuser

# =====================================================================
# Logging Configuration
# =====================================================================
# Log to syslog using facility local5
# This allows rsyslog to identify SNMP traps and apply the correct template

# Output format: OID followed by variable bindings
format1 %b %N %V\n

# Log to syslog facility local5
logoption f /dev/log
logoption s 5

# =====================================================================
# Trap Handler (Optional)
# =====================================================================
# You can define specific trap handlers here if needed
# Example:
# traphandle .1.3.6.1.4.1.9.9.41.2 /usr/local/bin/handle_cisco_trap.sh

# =====================================================================
# Configuration Notes
# =====================================================================
# - Facility local5 is reserved for SNMP traps
# - rsyslog will match on facility local5 to identify these messages
# - Format1 provides: timestamp, notification OID, and variable bindings
# - Adjust authCommunity to restrict which communities are accepted
# - For production, consider using SNMPv3 for encryption and authentication
# =====================================================================
