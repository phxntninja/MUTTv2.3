<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<svg xmlns="http://www.w3.org/2000/svg" width="1080" height="640" viewBox="0 0 1080 640">
  <style>
    .box { fill:#ffffff; stroke:#1f2937; stroke-width:2; rx:8; ry:8; }
    .title { font: 600 14px sans-serif; fill:#111827; }
    .text { font: 12px sans-serif; fill:#374151; }
    .arrow { stroke:#374151; stroke-width:2; marker-end:url(#arrowhead); fill:none; }
    .dashed { stroke-dasharray:4 4; }
    .note { font: 11px sans-serif; fill:#6b7280; }
  </style>
  <defs>
    <marker id="arrowhead" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#374151"/>
    </marker>
  </defs>

  <!-- Sources: rsyslog + snmptrapd -->
  <rect class="box" x="30" y="60" width="220" height="120"/>
  <text class="title" x="40" y="85">Sources</text>
  <text class="text" x="40" y="110">• rsyslog (514/tcp, 514/udp)</text>
  <text class="text" x="40" y="130">• snmptrapd (162/udp)</text>
  <text class="note" x="40" y="152">Adapters may post JSON via rsyslog → Ingestor</text>

  <!-- Ingestor -->
  <rect class="box" x="300" y="60" width="200" height="120"/>
  <text class="title" x="310" y="85">Ingestor</text>
  <text class="text" x="310" y="110">HTTP: 8080 (/api/v2/ingest)</text>
  <text class="text" x="310" y="130">Backpressure + validation</text>

  <!-- Arrow Sources -> Ingestor -->
  <path class="arrow" d="M250 120 L295 120"/>

  <!-- Redis -->
  <rect class="box" x="560" y="40" width="200" height="100"/>
  <text class="title" x="570" y="65">Redis</text>
  <text class="text" x="570" y="90">ingest_queue, alert_queue</text>
  <text class="text" x="570" y="110">rate-limit, circuit state</text>

  <!-- Ingestor -> Redis -->
  <path class="arrow" d="M500 120 L555 90"/>

  <!-- Alerter -->
  <rect class="box" x="560" y="170" width="200" height="120"/>
  <text class="title" x="570" y="195">Alerter</text>
  <text class="text" x="570" y="220">metrics:8081, health:8082</text>
  <text class="text" x="570" y="240">BRPOPLPUSH + rules</text>

  <!-- Redis -> Alerter (ingest_queue) -->
  <path class="arrow" d="M660 140 L660 165"/>

  <!-- PostgreSQL -->
  <rect class="box" x="820" y="170" width="220" height="120"/>
  <text class="title" x="830" y="195">PostgreSQL</text>
  <text class="text" x="830" y="220">event_audit_log</text>
  <text class="text" x="830" y="240">config_audit_log</text>

  <!-- Alerter -> PostgreSQL (audit) -->
  <path class="arrow" d="M760 230 L815 230"/>

  <!-- Alerter -> Redis (alert_queue) -->
  <path class="arrow" d="M660 290 L660 335"/>

  <!-- Moog Forwarder -->
  <rect class="box" x="560" y="340" width="200" height="120"/>
  <text class="title" x="570" y="365">Moog Forwarder</text>
  <text class="text" x="570" y="390">metrics:8083, health:8084</text>
  <text class="text" x="570" y="410">rate-limit + circuit breaker</text>

  <!-- Moogsoft -->
  <rect class="box" x="820" y="340" width="220" height="120"/>
  <text class="title" x="830" y="365">Moogsoft (Webhook)</text>
  <text class="text" x="830" y="390">/events</text>

  <!-- Forwarder -> Moogsoft -->
  <path class="arrow" d="M760 400 L815 400"/>

  <!-- Web UI -->
  <rect class="box" x="300" y="340" width="200" height="120"/>
  <text class="title" x="310" y="365">Web UI (API)</text>
  <text class="text" x="310" y="390">HTTP: 8090</text>
  <text class="text" x="310" y="410">metrics, rules, audit, teams</text>

  <!-- Web UI -> Postgres (config audit) -->
  <path class="arrow" d="M500 400 L815 400" class="arrow dashed"/>

  <!-- Prometheus / Grafana (optional) -->
  <rect class="box" x="30" y="260" width="220" height="120"/>
  <text class="title" x="40" y="285">Prometheus / Grafana</text>
  <text class="text" x="40" y="310">scrapes metrics ports</text>
  <text class="text" x="40" y="330">alerts-v25.yml</text>

  <!-- Scrape arrows -->
  <path class="arrow dashed" d="M250 300 L555 210"/>
  <path class="arrow dashed" d="M250 320 L555 380"/>
  <path class="arrow dashed" d="M250 340 L295 380"/>

  <!-- Vault (secrets) -->
  <rect class="box" x="300" y="210" width="200" height="90"/>
  <text class="title" x="310" y="235">Vault (AppRole)</text>
  <text class="text" x="310" y="255">secrets for services</text>

  <!-- Dotted associations to services -->
  <path class="arrow dashed" d="M400 210 L400 180"/>
  <path class="arrow dashed" d="M400 300 L400 340"/>

  <!-- Legend -->
  <text class="note" x="30" y="420">Solid arrows: primary data flow</text>
  <text class="note" x="30" y="438">Dashed arrows: metrics/secrets associations</text>
  <text class="note" x="30" y="456">Auth: X-API-KEY required for APIs; health/metrics public</text>

</svg>

