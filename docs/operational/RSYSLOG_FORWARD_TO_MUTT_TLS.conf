module(load="omhttp")

# Template to format syslog as JSON expected by MUTT Ingestor
template(name="MUTTJsonFormat" type="string"
         string="{\"hostname\":\"%HOSTNAME%\",\"message\":\"%msg%\",\"timestamp\":\"%timereported:::date-rfc3339%\"}")

# Forward messages to MUTT Ingestor over HTTPS with custom CA
action(
  type="omhttp"
  server="mutt-ingestor.example.com"
  port="8443"
  restpath="/ingest"
  usehttps="on"
  tls.cacert="/etc/mutt/certs/mutt_ingestor_ca.crt"
  header="X-API-KEY: REPLACE_WITH_INGESTOR_API_KEY"
  template="MUTTJsonFormat"
)

